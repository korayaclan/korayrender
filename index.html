<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KorayRender - RStudio 3D Map Simulator</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="logo-container">
            <div class="logo-text">KorayRender</div>
            <div class="subtitle">RStudio 3D Map Simulator</div>
        </div>
        <div class="social-links">
            <a href="https://github.com/korayaclan" target="_blank" class="social-btn">
                <i class="ph ph-github-logo"></i>
                korayaclan
            </a>
            <a href="https://x.com/kryaclan" target="_blank" class="social-btn">
                <i class="ph ph-x-logo"></i>
                kryaclan
            </a>
        </div>
    </div>

    <div class="container">
        <!-- Left Panel -->
        <div class="panel" id="leftPanel">
            <div class="panel-section">
                <h2><i class="ph ph-map-pin"></i> Location</h2>



                <div class="info-box">
                    Click on map to select location
                </div>

                <div class="control-group">
                    <label>Longitude</label>
                    <input type="number" id="center-lon" step="0.000001" value="28.9784">
                </div>

                <div class="control-group">
                    <label>Latitude</label>
                    <input type="number" id="center-lat" step="0.000001" value="41.0082">
                </div>

                <button class="btn btn-primary" onclick="updateMapCenter()">
                    <i class="ph ph-arrows-clockwise"></i> Update Map
                </button>
            </div>

            <div class="panel-section">
                <h2><i class="ph ph-camera"></i> Camera</h2>

                <div class="preset-grid">
                    <button class="btn btn-secondary" onclick="applyPreset('aerial')">Aerial</button>
                    <button class="btn btn-secondary" onclick="applyPreset('street')">Street</button>
                    <button class="btn btn-secondary" onclick="applyPreset('bird')">Bird's Eye</button>
                    <button class="btn btn-secondary" onclick="applyPreset('dramatic')">Dramatic</button>
                </div>

                <div class="control-group">
                    <label>Height (Z) <span class="value-display" id="lookfrom-z-val">1000</span></label>
                    <input type="range" id="lookfrom-z" min="100" max="5000" value="1000" step="50">
                </div>

                <div class="control-group">
                    <label>Distance (X) <span class="value-display" id="lookfrom-x-val">0</span></label>
                    <input type="range" id="lookfrom-x" min="-3000" max="3000" value="0" step="50">
                </div>

                <div class="control-group">
                    <label>Distance (Y) <span class="value-display" id="lookfrom-y-val">650</span></label>
                    <input type="range" id="lookfrom-y" min="-3000" max="3000" value="650" step="50">
                </div>

                <div class="control-group">
                    <label>FOV <span class="value-display" id="fov-val">60°</span></label>
                    <input type="range" id="fov" min="10" max="120" value="60" step="1">
                </div>

                <div class="control-group">
                    <label>Radius <span class="value-display" id="radius-val">1000</span></label>
                    <input type="range" id="radius" min="100" max="3000" value="1000" step="50">
                </div>

                <div class="control-group">
                    <label>Rotation <span class="value-display" id="theta-val">45°</span></label>
                    <input type="range" id="theta" min="0" max="360" value="45" step="5">
                </div>

                <div class="control-group">
                    <label>Tilt <span class="value-display" id="phi-val">30°</span></label>
                    <input type="range" id="phi" min="0" max="90" value="30" step="5">
                </div>
            </div>
        </div>

        <!-- Main View -->
        <div class="main-view" style="position: relative;">
            <div class="search-container">
                <div class="search-group">
                    <input type="text" id="location-search" placeholder="City, Place..." autocomplete="off">
                    <button class="btn-search" onclick="searchLocation()">
                        <i class="ph ph-magnifying-glass"></i>
                    </button>
                </div>
                <div id="search-suggestions" class="suggestions-dropdown"></div>
            </div>
            <div id="map"></div>
            <div id="canvas-container">
                <canvas id="preview-canvas"></canvas>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="panel right-panel" id="rightPanel">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('layers')">
                    <i class="ph ph-stack"></i> Layers
                </button>
                <button class="tab-btn" onclick="switchTab('render')">
                    <i class="ph ph-gear"></i> Render
                </button>
                <button class="tab-btn" onclick="switchTab('code')">
                    <i class="ph ph-code"></i> Code
                </button>
            </div>

            <!-- Layers Tab -->
            <div id="tab-layers" class="tab-content active">
                <div class="panel-section">
                    <!-- Buildings -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-buildings"></i> Buildings</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-buildings" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-row">
                            <span class="color-label">Low</span>
                            <input type="color" id="color-bld-low" value="#c88a1e">
                            <span class="color-label">Mid</span>
                            <input type="color" id="color-bld-mid" value="#b7720e">
                            <span class="color-label">High</span>
                            <input type="color" id="color-bld-high" value="#98590a">
                        </div>
                        <div class="control-group" style="margin-top: 8px;">
                            <label>Height Multiplier <span class="value-display"
                                    id="bld-height-mult-val">1.0</span></label>
                            <input type="range" id="bld-height-mult" min="0.5" max="2" value="1" step="0.1">
                        </div>
                    </div>

                    <!-- Parks -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-tree"></i> Parks</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-parks" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-row">
                            <span class="color-label">Color</span>
                            <input type="color" id="color-park" value="#66A61E">
                        </div>
                    </div>

                    <!-- Water -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-drop"></i> Water</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-water" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-row">
                            <span class="color-label">Color</span>
                            <input type="color" id="color-water" value="#3E8fe0">
                        </div>
                        <div class="control-group" style="margin-top: 8px;">
                            <label>Metal Fuzz <span class="value-display" id="water-fuzz-val">0.5</span></label>
                            <input type="range" id="water-fuzz" min="0" max="1" value="0.5" step="0.1">
                        </div>
                    </div>

                    <!-- Roads -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-road-horizon"></i> Roads</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-roads" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-row">
                            <span class="color-label">Base</span>
                            <input type="color" id="color-road" value="#7e8792">
                            <span class="color-label">High</span>
                            <input type="color" id="color-road-hi" value="#e6ebf1">
                        </div>
                        <div class="control-group" style="margin-top: 8px;">
                            <label>Width <span class="value-display" id="road-width-val">3</span></label>
                            <input type="range" id="road-width" min="1" max="10" value="3" step="0.5">
                        </div>
                    </div>

                    <!-- Railways -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-train"></i> Railways</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-rails" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="control-group">
                            <label>Width <span class="value-display" id="rail-width-val">2</span></label>
                            <input type="range" id="rail-width" min="1" max="5" value="2" step="0.5">
                        </div>
                    </div>

                    <!-- Land Use -->
                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title"><i class="ph ph-landscape"></i> Land Use</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="layer-landuse" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="color-row">
                            <span class="color-label">Color</span>
                            <input type="color" id="color-landuse" value="#b89c3a">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Render Tab -->
            <div id="tab-render" class="tab-content">
                <div class="panel-section">
                    <h2><i class="ph ph-image"></i> Output</h2>
                    <div class="control-group">
                        <label>Format</label>
                        <select id="aspect-ratio">
                            <option value="16:9">Wide (16:9)</option>
                            <option value="1:1">Square (1:1)</option>
                            <option value="4:3">Classic (4:3)</option>
                            <option value="21:9">Cinema (21:9)</option>
                            <option value="9:16">Vertical (9:16)</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>

                    <div id="custom-dimensions" style="display: none;">
                        <div class="control-group">
                            <label>Width <span class="value-display" id="render-width-val">1800</span></label>
                            <input type="range" id="render-width" min="800" max="4000" value="1800" step="100">
                        </div>
                        <div class="control-group">
                            <label>Height <span class="value-display" id="render-height-val">1800</span></label>
                            <input type="range" id="render-height" min="800" max="4000" value="1800" step="100">
                        </div>
                    </div>

                    <div class="control-group">
                        <label>Quality (Samples) <span class="value-display" id="render-samples-val">100</span></label>
                        <input type="range" id="render-samples" min="50" max="500" value="100" step="50">
                    </div>

                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title">Denoise</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="render-denoise" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="layer-card">
                        <div class="layer-header">
                            <span class="layer-title">Ambient Light</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="render-ambient" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <h2><i class="ph ph-lightbulb"></i> Lighting</h2>
                    <div class="control-group">
                        <label>Intensity <span class="value-display" id="light-intensity-val">15</span></label>
                        <input type="range" id="light-intensity" min="5" max="30" value="15" step="1">
                    </div>

                    <div class="control-group">
                        <label>Position X <span class="value-display" id="light-x-val">-1200</span></label>
                        <input type="range" id="light-x" min="-2000" max="2000" value="-1200" step="100">
                    </div>

                    <div class="control-group">
                        <label>Position Y <span class="value-display" id="light-y-val">2500</span></label>
                        <input type="range" id="light-y" min="1000" max="5000" value="2500" step="100">
                    </div>

                    <div class="control-group">
                        <label>Position Z <span class="value-display" id="light-z-val">-1200</span></label>
                        <input type="range" id="light-z" min="-2000" max="2000" value="-1200" step="100">
                    </div>

                    <div class="control-group">
                        <label>Radius <span class="value-display" id="light-radius-val">400</span></label>
                        <input type="range" id="light-radius" min="100" max="800" value="400" step="50">
                    </div>

                    <h2><i class="ph ph-paint-bucket"></i> Background</h2>
                    <div class="layer-card">
                        <div class="color-row">
                            <span class="color-label">Top</span>
                            <input type="color" id="bg-high" value="#FFFFFF">
                            <span class="color-label">Bottom</span>
                            <input type="color" id="bg-low" value="#FFFFFF">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Code Tab -->
            <div id="tab-code" class="tab-content">
                <div class="panel-section">
                    <div class="info-box">
                        Copy this code and run it in RStudio
                    </div>

                    <button class="btn btn-primary" onclick="openPreviewModal()"
                        style="margin-bottom: 10px; background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); color: white;">
                        <i class="ph ph-cube"></i> Live 3D Preview
                    </button>

                    <button class="btn btn-primary" onclick="copyCode()">
                        <i class="ph ph-copy"></i> Copy Code
                    </button>

                    <pre id="r-code" class="code-block"></pre>

                    <button class="btn btn-secondary" onclick="exportSettings()">
                        <i class="ph ph-download-simple"></i> Export Settings (JSON)
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <div class="mobile-controls">
        <button class="mobile-btn" onclick="toggleMobileMenu()">
            <i class="ph ph-list"></i>
        </button>
    </div>

    <!-- 3D Preview Modal -->
    <div id="preview-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="ph ph-cube"></i> Live 3D Preview</h2>
                <button class="close-btn" onclick="closePreviewModal()"><i class="ph ph-x"></i></button>
            </div>
            <div id="three-container"></div>
            <div class="modal-footer">
                <div class="loading-indicator" id="preview-loading">
                    <i class="ph ph-spinner ph-spin"></i> Fetching OSM Data...
                </div>
                <div class="preview-controls">
                    <small>Left Click: Rotate | Right Click: Pan | Scroll: Zoom</small>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>

</html>